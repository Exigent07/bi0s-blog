---
title: Nullbyte - VulnHub VM Challenge
date: 2021-08-10 12:40:31
author: 01_susil
author_url: https://twitter.com/Susilkessav1
categories:
 - Pentest
 - VulnHub
tags:	
 - Vulnhub
 - WriteUp
 - Nullbyte
   
   
---

**tl;dr**

+ Reading meta data using Exiftool.
+ Using sqlmap to get Password hash.


<!--more-->

Solved by: [01_susil](https://twitter.com/Susilkessav1)

This is a Linux box with IP 192.168.12.7

## Initial Analysis

Doing a Port scan [nmap enumerator](https://github.com/nmap/nmap), Basic scan.

![Nmap](first.png)

The system is running OpenSSH, Apache web server and rpcbind.

Opening up the browser to check for more details.

![website](second.png)

![image](third.png)

Exiftool is a command-line interface to Image ExifTool, used for reading and writing meta information in image, audio and video files.

Using [Exiftool](https://github.com/exiftool/exiftool) to read the meta data of the image.

![exif](forth.png)

kzMb5nVYJw is a directory. Let's check it out.

![key](fifth.png)

![source](sixth.png)

From page source It says the form is not connected to mysql and the password is not complex.

So I decided to try Bruteforce. I used [hydra](https://github.com/vanhauser-thc/thc-hydra) to bruteforce.

![hydra](seventh.png)

The password is elite for /kzmb5nVYJw/index.php.

![page](eighth.png)

The page fetches usernames which is vulnerable to sqli injections.

The database contained a users table. This might be a table containing username and
passwords. Lets dump them all:

![sql](eleventh.png)

It fetched tables for database seth. And we got a table "seth.users".

![sql](twelfth.png)

We got a password! And it looked like it was encoded with base64. Let's try decoding it:

![pass](thirteen.png)

Found Username and Base64 encrypted password. 
By decrypting base64 got md5 hashed password.

![decr](fourteen.png)

By decrypting md5 hash we got omega as password.

## Exploit

Now we found username and password for SSH.

![ssh](sixteen.png)

![ls](twenty.png)

From bash_history there is prowatch file which is getting executed ./prowatch. 

![pro](seventeen.png)

./prowatch is executing the function of ps which shows the details of the process.
It's giving a bash but ps was giving a sh. Prowatch is running with root privileges.
Using "ln" assign ps to ls.

![pro](eighteen.png)

By using path inclusion method let's export our current directory to the path.

![root](ninteen.png)

Got root access and proof.txt which contains flag.
